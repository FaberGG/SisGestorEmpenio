<UserControl
    x:Class="SisGestorEmpenio.vistas.ConsultarPrestamosView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    MinWidth="850"
    MinHeight="500"
    Background="#F5F7FA">

    <UserControl.Resources>
        <!--  Estilos para los controles  -->
        <Style x:Key="ComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Height" Value="38" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Padding" Value="8,5" />
        </Style>

        <Style x:Key="SearchBoxStyle" TargetType="TextBox">
            <Setter Property="Height" Value="38" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Padding" Value="5" />
        </Style>

        <Style x:Key="ControlBorderStyle" TargetType="Border">
            <Setter Property="Background" Value="White" />
            <Setter Property="CornerRadius" Value="6" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="BorderBrush" Value="#E0E0E0" />
        </Style>

        <!--  Plantilla para el botón de tres puntos  -->
        <Style x:Key="EllipsisButtonStyle" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Padding="8,0" Background="Transparent">
                            <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                FontSize="20"
                                FontWeight="Bold"
                                Foreground="#505A64"
                                Text="&#8942;" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <!--  Estilos para los botones de paginación  -->
        <Style x:Key="PaginationButtonStyle" TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            x:Name="border"
                            Margin="2,0"
                            Padding="8,6"
                            Background="White"
                            BorderBrush="#E0E0E0"
                            BorderThickness="1"
                            CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#F5F7FA" />
                                <Setter TargetName="border" Property="BorderBrush" Value="#3498DB" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="border" Property="Background" Value="#E8F4FD" />
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="border" Property="Background" Value="#F8F9FA" />
                                <Setter TargetName="border" Property="BorderBrush" Value="#E9ECEF" />
                                <Setter Property="Foreground" Value="#6C757D" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="MinWidth" Value="32" />
            <Setter Property="Height" Value="36" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Foreground" Value="#495057" />
            <Setter Property="Cursor" Value="Hand" />
        </Style>

        <Style
            x:Key="PaginationButtonActiveStyle"
            BasedOn="{StaticResource PaginationButtonStyle}"
            TargetType="Button">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            Margin="2,0"
                            Padding="8,6"
                            Background="#3498DB"
                            BorderBrush="#3498DB"
                            BorderThickness="1"
                            CornerRadius="4">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontWeight" Value="SemiBold" />
        </Style>

        <Style
            x:Key="NavigationButtonStyle"
            BasedOn="{StaticResource PaginationButtonStyle}"
            TargetType="Button">
            <Setter Property="MinWidth" Value="80" />
            <Setter Property="Padding" Value="12,6" />
        </Style>
    </UserControl.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!--  Panel de título  -->
        <Border
            Grid.Row="0"
            Padding="20,15"
            Background="White"
            BorderBrush="#E0E0E0"
            BorderThickness="0,0,0,1">
            <TextBlock
                FontSize="20"
                FontWeight="Medium"
                Foreground="#333333"
                Text="Consulta de Préstamos" />
        </Border>

        <!--  Contenido  -->
        <Grid Grid.Row="1" Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <!--  FILTROS  -->
            <StackPanel
                Grid.Row="0"
                Margin="0,0,0,20"
                Orientation="Horizontal">
                <!--  Estado  -->
                <Border Margin="0,0,10,0" Style="{StaticResource ControlBorderStyle}">
                    <ComboBox
                        x:Name="cmbEstado"
                        Width="120"
                        SelectedIndex="0"
                        SelectionChanged="Filtro_SelectionChanged"
                        Style="{StaticResource ComboBoxStyle}">
                        <ComboBoxItem Content="Estado" IsEnabled="False" />
                        <ComboBoxItem Content="Activo" />
                        <ComboBoxItem Content="Inactivo" />
                        <ComboBoxItem Content="Todos" />
                    </ComboBox>
                </Border>

                <!--  Rango de tiempo  -->
                <Border Margin="0,0,10,0" Style="{StaticResource ControlBorderStyle}">
                    <ComboBox
                        x:Name="cmbRangoTiempo"
                        Width="150"
                        SelectedIndex="0"
                        SelectionChanged="Filtro_SelectionChanged"
                        Style="{StaticResource ComboBoxStyle}">
                        <ComboBoxItem Content="Rango de tiempo" IsEnabled="False" />
                        <ComboBoxItem Content="Hoy" />
                        <ComboBoxItem Content="Últimos 5 días" />
                        <ComboBoxItem Content="Últimos 8 días" />
                        <ComboBoxItem Content="Últimos 15 días" />
                        <ComboBoxItem Content="Últimos 30 días" />
                        <ComboBoxItem Content="Todo el tiempo" />
                    </ComboBox>
                </Border>

                <!--  Identificación  -->
                <Border Style="{StaticResource ControlBorderStyle}">
                    <TextBox
                        x:Name="txtIdentificacion"
                        Width="220"
                        Padding="12,0,5,0"
                        Foreground="Gray"
                        GotFocus="TxtIdentificacion_GotFocus"
                        LostFocus="TxtIdentificacion_LostFocus"
                        Style="{StaticResource SearchBoxStyle}"
                        Text="Identificación..."
                        TextChanged="TxtIdentificacion_TextChanged" />
                </Border>
            </StackPanel>

            <!--  DATA GRID  -->
            <Border
                Grid.Row="1"
                Background="White"
                BorderBrush="#E0E0E0"
                BorderThickness="1"
                CornerRadius="8">
                <DataGrid
                    x:Name="dgPrestamos"
                    AlternatingRowBackground="#F9FAFC"
                    AutoGenerateColumns="False"
                    BorderThickness="0"
                    CanUserAddRows="False"
                    ColumnHeaderHeight="40"
                    GridLinesVisibility="None"
                    HeadersVisibility="Column"
                    IsReadOnly="True"
                    RowBackground="White"
                    RowHeight="50"
                    SelectionMode="Single"
                    SelectionUnit="FullRow">

                    <DataGrid.Resources>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="Background" Value="White" />
                            <Setter Property="Foreground" Value="#505A64" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                            <Setter Property="Padding" Value="12,0" />
                            <Setter Property="BorderThickness" Value="0,0,0,1" />
                            <Setter Property="BorderBrush" Value="#EEEEEE" />
                            <Setter Property="Height" Value="50" />
                            <Setter Property="VerticalContentAlignment" Value="Center" />
                        </Style>
                        <Style TargetType="DataGridCell">
                            <Setter Property="Padding" Value="12,0" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="DataGridCell">
                                        <Border
                                            Padding="{TemplateBinding Padding}"
                                            Background="{TemplateBinding Background}"
                                            BorderThickness="0">
                                            <ContentPresenter VerticalAlignment="Center" />
                                        </Border>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </DataGrid.Resources>

                    <DataGrid.Columns>
                        <!--  ID Cliente  -->
                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding ClienteId}"
                            Header="Identificación" />
                        <!--  Nombre Cliente  -->
                        <DataGridTextColumn
                            Width="1.5*"
                            Binding="{Binding ClienteNombre}"
                            Header="Nombre Cliente" />
                        <!--  Artículo  -->
                        <DataGridTextColumn
                            Width="1.5*"
                            Binding="{Binding ArticuloNombre}"
                            Header="Artículo" />
                        <!--  Fecha Inicio  -->
                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding FechaInicio}"
                            Header="Fecha Inicio" />
                        <!--  Fecha Fin  -->
                        <DataGridTextColumn
                            Width="*"
                            Binding="{Binding FechaFin}"
                            Header="Fecha Fin" />

                        <!--  Estado con template  -->
                        <DataGridTemplateColumn Width="*" Header="Estado">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border
                                        Padding="8,4"
                                        HorizontalAlignment="Left"
                                        CornerRadius="4">
                                        <Border.Style>
                                            <Style TargetType="Border">
                                                <Setter Property="Background" Value="#EEEEEE" />
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Estado}" Value="activo">
                                                        <Setter Property="Background" Value="#E8F5E9" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Estado}" Value="inactivo">
                                                        <Setter Property="Background" Value="#FFEBEE" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Border.Style>
                                        <TextBlock Text="{Binding Estado}">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Foreground" Value="#333333" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding Estado}" Value="activo">
                                                            <Setter Property="Foreground" Value="#2E7D32" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding Estado}" Value="inactivo">
                                                            <Setter Property="Foreground" Value="#C62828" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Border>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>

                        <!--  Botón de acciones  -->
                        <DataGridTemplateColumn Width="60" Header="">
                            <DataGridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Button
                                        Click="BtnVerDetalles_Click"
                                        Style="{StaticResource EllipsisButtonStyle}"
                                        Tag="{Binding IdPrestamo}">
                                        <Button.ContextMenu>
                                            <ContextMenu>
                                                <MenuItem
                                                    Click="MenuVerDetallesPrestamo_Click"
                                                    Header="Ver Detalles"
                                                    Tag="{Binding IdPrestamo}" />
                                            </ContextMenu>
                                        </Button.ContextMenu>
                                    </Button>
                                </DataTemplate>
                            </DataGridTemplateColumn.CellTemplate>
                        </DataGridTemplateColumn>
                    </DataGrid.Columns>
                </DataGrid>
            </Border>
        </Grid>

        <!--  BARRA DE PAGINACIÓN  -->
        <Border
            Grid.Row="2"
            Padding="20,15"
            Background="White"
            BorderBrush="#E0E0E0"
            BorderThickness="0,1,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!--  Información de registros  -->
                <TextBlock
                    x:Name="txtInfoRegistros"
                    Grid.Column="0"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Foreground="#6C757D"
                    Text="Mostrando 1-10 de 100 registros" />

                <!--  Controles de navegación  -->
                <StackPanel Grid.Column="2" Orientation="Horizontal">
                    <!--  Botón Anterior  -->
                    <Button
                        x:Name="btnAnterior"
                        Margin="0,0,10,0"
                        Click="BtnAnterior_Click"
                        Content="Anterior"
                        Style="{StaticResource NavigationButtonStyle}" />

                    <!--  Panel de números de página  -->
                    <StackPanel
                        x:Name="pnlPaginas"
                        Margin="0,0,10,0"
                        VerticalAlignment="Center"
                        Orientation="Horizontal" />

                    <!--  Botón Siguiente  -->
                    <Button
                        x:Name="btnSiguiente"
                        Click="BtnSiguiente_Click"
                        Content="Siguiente"
                        Style="{StaticResource NavigationButtonStyle}" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>